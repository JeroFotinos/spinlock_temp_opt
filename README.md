# spinlock_temp_opt
Temperature homogeneization project for improving a device designed by Spinlock SRL, a company that produces equipment for measuring the composition of samples through NMR. This was a week-long project carried out during the 6th [TAMI](https://sites.google.com/view/ganycfamaf/tami-2025/principal?authuser=0), a workshop on mathematics for industry where different companies brought problems limiting their productivity and groups of graduate students tried to provide solutions, or point the way toward them. In our case, Spinlock wanted to improve temperature homogenization in the samples to achieve lower measurment uncertainties, unlocking new market segments.

Our proposal is divided into three main steps. The first one consists of improvements to the overall design, that can be read in the report `report_Spinlock_TAMI.pdf` (in Spanish for now). Secondly, we propose a framework for simulating the temperature evolution of the system, and provide an example with a single “rack” (a sample-holder). After including more details concerning the geometry and materials of the equipment (by providing a more detaild `.msh` file than the ones used here), changes in design could be quantitatively evaluated.

![](https://github.com/JeroFotinos/spinlock_temp_opt/raw/main/temp_evolution_twoRes.gif)

Lastly, if the uncertainty in the temperature was not low enough after the design changes obtained from the previous steps, we propose a Reinforcement Learning approach for real-time control of the resistances that control the temperature of the equipement. The idea stems from the similarity between this case and the classic cart-pole problem: here, ambient temperature is lower than the target temperature of the samples, that are heated by applying currents through resistances. Thus, keeping the temperature at the target value resembles the cart-pole problem of maintaining the system next to the unstable equilibrium. Moreover, the use of RL has been reported many times for a similar problem, namely, that of Heating, Ventilation, and Air Conditioning (HVAC) in buildings. The approaches are really diverse, including multi-agent Deep RL, meta-RL, etc. Here, we propose to use Proximal Policy Optimization (PPO) to learn the policy of a single agent controling all the resistences, having the information of all the sensors.

![](https://github.com/JeroFotinos/spinlock_temp_opt/raw/main/temperature_evolution.gif)

Again, the approach outlined here should be expanded upon to be able to handle the diversity and complexity of real-life scenarios.